/* Add custom commands to 'Commands > Network' menu */

INSERT INTO `customcommands` (`Name`, `Command`, `Parameters`, `AppID`, `ExtraField`, `FolderID`, `Local`, `OutPutFile`, `DataToSend`) VALUES('LB - Scan Network','%windir%\\system32\\reg.exe','add HKLM\\Software\\Wow6432Node\\LabTech\\Probe\\Commands /v PerformDiscovery /d \"1\" /f','0','0','0','10','','');
INSERT INTO `customcommands` (`Name`, `Command`, `Parameters`, `AppID`, `ExtraField`, `FolderID`, `Local`, `OutPutFile`, `DataToSend`) VALUES('LB - Refresh Config','%windir%\\system32\\reg.exe','add HKLM\\Software\\Wow6432Node\\LabTech\\Probe\\Commands /v ReloadConfig /d \"1\" /f','0','0','0','10','','');

/* Add scripts to 'Lunar Gust' scripts folder */

INSERT INTO ScriptFolders (ParentID,NAME) VALUES(0,'Lunar Breeze');
SET @lunfolderid = (SELECT `FolderID` FROM `scriptfolders` WHERE `Name` = 'Lunar Breeze');

INSERT INTO `lt_scripts` (`FolderId`, `ScriptName`, `ScriptNotes`, `Permission`, `EditPermission`, `ComputerScript`, `LocationScript`, `MaintenanceScript`, `FunctionScript`, `LicenseData`, `ScriptData`, `ScriptVersion`, `ScriptGuid`, `ScriptFlags`, `Parameters`, `Last_User`, `Last_Date`) VALUES(@lunfolderid,'Deploy Lunar Breeze','The purpose of this script is to install the Lunar Breeze application on the target machine as a service.','0,','0,','1','0','0','0','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','1','d2c32e03-7f4f-11e5-911d-00e04c78468e','0','','Admin@LabTech',NOW());
INSERT INTO `lt_scripts` (`FolderId`, `ScriptName`, `ScriptNotes`, `Permission`, `EditPermission`, `ComputerScript`, `LocationScript`, `MaintenanceScript`, `FunctionScript`, `LicenseData`, `ScriptData`, `ScriptVersion`, `ScriptGuid`, `ScriptFlags`, `Parameters`, `Last_User`, `Last_Date`) VALUES(@lunfolderid,'Remove Lunar Breeze From Agent','The purpose of this script is to reverse changes made to an agent from the \'Deploy Lunar Breeze\' script and removes any associated files. This script only affects the functionality of the target agent. ','0,','0,','1','0','0','0','H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ih4/L6b5ssmfZm129PjN9So/2n18l38+frVenlTrZZvXRzuP73p/PT59typqvJMfvV4vZ9n1KP1Otlxn9XV6b3eU7u3sfpo+fLSz+2j/Xvryi8d3vfaPX0/rYtX+ZF43RbUE4PAD/f7zdTE72rt/Pp1kn55vTw/u59u7u/n97ez++e72zk6+sz99cLD/6UFu3ucXHt/1h/MbJ/8P39zqB94AAAA=','H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ih6/ntbFqn2atdnRb5ykqf7d8B/05+m7ts7w7bMiL2dNetd88TKrs0Xe5rX32edlNclK7wMB9pPUqKiWR7uP74YfBK0+Xxezo73759NJ9un59vTgfr69u5vf387un+9u7+zkO/vTBwf7nx7kBgq/wDjrB40/gtdtvrKjOJ62ioD+pp8/Wy/577MZvvP+8ge52xn0Xufve52/9zt/3/foUdXt0Q7hi5/62Um1bIvlOsfn9nf97svmebEo+BXzq35ztpzlyzbjwdC3/p8+SRwVNpBlbwNZ9h4O0+XobNnm1PEsbat0kqf1eplWy/S7xXJWXTXpl6/pr/J6nNJoa/px+q6gwV2kDSMyfnxXofwc03b3058z4u5upO7OzwqFdkMK/b+dQvc2UehR02Z1+yavF8Uya/OXdTXNmyZvflYIt/f+hPu5E9t7n24gW7leZvWkzvMf5D8rlLo3QKndr0up3Z9FSu1uolSbNW/fFmWZ3i0WqUe2cf4uT++e/6xQb/+HSr0PpN79H57ZvP//Jbrs7u7cTgDBSXE2OvpdH5FxHVRuex9EzE+/aWX2s0nMvU203B2g3lfLbFLm8ExaQ8L04w7hP05XQlXjjHSIepSTy/IFfZ9dmEm6915kfvBNk3nvmybzrb2RR6CFzN/Pito7+P8UqTa7JZvk9pul2sNvmmo/m07JbZy5V/miusxf5/VlMf3Z8U52v0aM8HNIs03uSTNNZ3lJQXj6kafZPnofst2ebEOBw/8r7e/9DWT7hv2S3aHA4P+VhNndvXc7x2STUxIT0g/zR3aHYoavLZQ/m0T8QIekZvIF3sjHaSPU/NnyRHYHwoqvT+CfVfv6c+qK7A6FGv/vpNWNvsgPwaZ+4/HEz6pNvbUf8qwof5Yct91vPDT4ehS7LcU2EOx3L9vmcjor6t/9911l07ekoZrf11Ntv++3hmPcDyXiwf+nTO+HEXFWlj87RByKIf7/SMTV9exnhYjwCP4/RMRPrQPz/lT82aHf/6eiCzhTg0z47d/r+Re/7+vqvL3K6vz3/W519en+vb0X1Sz/fZ9nkzf5dP77Ukpg8rNExv9vxSK39Fx+9qzw3jcedvxsWuGNTrGQapY+h6SmT1hU02m1WFVLwqZJm/UUeajzdUlLso6Y3yQxv/EQ42eTmD8Xa69733hg8bNKoY3i+Trnzxta+C+rq7SdF01aFss8Ja2XFsuWpJe4MWtSBGuSZ5+t67xBALzI3ubEkNSwYcwaL0d/UWfT/GeTS///FKp8eCC8mVb/nwpSNgr07+klUH7P9JT+KJYXyn4/S4x28E0T72fVFv9cqMNvfPXiFhQyfz/N2uzoN07+H0h8H5AAJwAA','1','25fcba6f-c85e-11e5-a5f1-00e04c78468e','0','','Admin@LabTech',NOW());
INSERT INTO `lt_scripts` (`FolderId`, `ScriptName`, `ScriptNotes`, `Permission`, `EditPermission`, `ComputerScript`, `LocationScript`, `MaintenanceScript`, `FunctionScript`, `LicenseData`, `ScriptData`, `ScriptVersion`, `ScriptGuid`, `ScriptFlags`, `Parameters`, `Last_User`, `Last_Date`) VALUES(@lunfolderid,'Update Settings on Agent From Configuration','The purpose of this script is to update the registry keys on the agent based on the values configured in the EDFs on the agent.','0,','0,','1','1','0','0','H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ih4/L6b5ssmfZm129PjN9So/2n18l38+frVenlTrZZvXRzuP73p/PT59typqvJMfvV4vZ9n1KP1Otlxn9XV6b3eU7u3sfpru7jza2X20t5++/OLxXe+Fx6+ndbFqfzKvm6JaAnL4gX7/+bqYHe09ON/LJ9PJ9vTg0+n27m5+fzu7f767vbOT7+xPHxzsf3qQm/f5hcd3/fH8xsn/A3IBkzjfAAAA','H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ih6/ntbFqn2atdnRb5ykqf7d8B/05+m7ts7w7bMiL2dNetd88TKrs0Xe5rX32edlNclK7wMB9pPUqKiWR7uP74YfBK0+Xxezo70H53v5ZDrZnh58Ot3e3c3vb2f3z3e3d3bynf3pg4P9Tw9yA4VfYJz1g8Yfwes2X9lRHE9bRUB/08+frZf899kM33l/+YPc7Qx6r/P3vc7f+52/73v0qOr2aIfwxU/97KRatsVyneNz+7t+92XzvFgU/Ir5Vb85W87yZZvxYOhb/0+fJI4KG8iyt4ks9x4OE+boUdNmdft53p4+ffaTWbnOm8d39auftxTb29lAsN3dOIGOXp8+Pz15k549e/HV8+dbW/rnH3A2+wPSZ6++/CL9A3II4jmE8A9Iv/vt01en6R/wrKoXf8BnH+9+nB6/eJr+Aa9z7pM+eb5eZnX6pM7zH+QpUei8uFjXPFRt+oJEl9q9nmbL9FW2vMibj++MtnfvHCp2e+F0Hb2eZktpRxN99lRb3XuvSdz9pidx90eTiEn8cpXLx036vLpIn+eXebl5Nu0bWUlv8Atff1r3fjStPyvT+rRoptVlXl/fdlbtC+81qfFJvffzdlLZivXndUYekJ1b9onYHzp7SjP1e3a04++pE8lf/u7TarFak5tUzH732+pYxuFrCeP+z9d52zo5fn2K+Xlhp/Cz9OMX1TL/OH2DTz/e+Tj4+rOPT+u6qhvz9W786/ST9Gx5TrKs+jL9Im+aDPZS39v7OD198fTO+zHMkALexDm3VefvyTwe89z/EfP8f4F5rJ7/BljHh/X1GefT/y8xzg0BTb6c/ayHMw++aXp9QDjzofTiAPC7ddHmr/KLomnr659Fwh38f4lwDzZpqLix76qrvQGx3Tb6rSOnR+bz/Y1kfPhNk/FnU173Hmwg47d/r9Pf5/d//uXJ8fPf/4vjk2+fvTj9fV9/+ezNd49fnf6+362uPt2/t/eimuW/7/Ns8iafzn/fl3U1yX9f8bofuTkYIL/n2PEs/Z4D07HztbTm7s7ANOx+3WnY+xrT8HM/DS5+NQZtaDoijs43PCVDOYqvPSX/35SMnosxNCM9/+Ebno+h5MLPn/lYLLLlrHn0Ki+rbCbTMzAZRve/H+kHST+UAvh/Jelvdup+WC7K7jcegv9s+ih7m8gWJKfShjtIiyadUWCU1uvlslhejH92iPiNh6K3IKL5+6kshf0/59d1dRkbAAA=','1','27f2ebcb-c86c-11e5-a5f1-00e04c78468e','0','','Admin@LabTech',NOW());
INSERT INTO `lt_scripts` (`FolderId`, `ScriptName`, `ScriptNotes`, `Permission`, `EditPermission`, `ComputerScript`, `LocationScript`, `MaintenanceScript`, `FunctionScript`, `LicenseData`, `ScriptData`, `ScriptVersion`, `ScriptGuid`, `ScriptFlags`, `Parameters`, `Last_User`, `Last_Date`) VALUES(@lunfolderid,'Update Network Inventory','The purpose of this script is to update to retrieve an updated network device inventory.','0,','0,','1','1','0','0','H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ih4/L6b5ssmfZm129PjN9So/2n18l38+frVenlTrZZvXRzuP73p/PT59typqvJMffVEtZ9n1KH2WT+p1Vl+nO7ujdG9n99P0/qN79x7tHKTHXzy+673w+PW0LlbtT+Z1U1RLQA4/0O8/Xxezo+zTB9n93en+9vQg+3R7dze/v53dP9/d3tnJd/anDw72Pz3Izfv8wuO7/nh+4+T/AYi+v3PfAAAA','H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ih6/ntbFqn2atdnRb5ykqf7d8B/05+m7ts7w7bMiL2dNetd88TKrs0Xe5rX32edlNcnK5miWXxbTvFisqrr9/Vd1dUFNf/9V1s4/O/nd7x3/7vdPnr95Pc/qHL+tl1n9pM7zH+AveUVeb8b5u/zxXQNTuxD0fpK6Larl0e7ju+EHQavP18XsKPv0QXZ/d7q/PT3IPt3e3c3vb2f3z3e3d3bynf3pg4P9Tw9yA4VfYCroB41Pk9dtvrJ4HE9bRUB/08+frZf899kM33l/+WTb7ZBxr/P3vc7f+52/77u/XxO9jnYIX/zUz06qZVss1zk+t7/rd182z4tFwa+YX/Wbs+UsX7YZD4a+9f/0SeKosIEse5vIcjBMl6PfvWyby+msqH/333eZt1dV/dYww0831fLxXW32wyDe7v8bibe3s4F4u3H6HP3u61VZZbN8dl6U+e+ujfakkSHaEcTzTfWVtnxGLbXhvfei5u7/l1hx7+EGar5aL5fF8iJt53l6XpVldYW/qiV/8DybvMmn87TJ68u8fpT+noMq7/dMP/o9+7T9PT9Kd9Pfc1otVmtSocXs9/xZYe29/y9NxoN7GyZjA30HmP59qN6Rhfek8r3/TymQByGVAyp/+/c6/X1+/+dfnhw///2/OD759tmL09/39ZfP3nz3+NXp7/vd6urT/Xt7L6pZ/vsq9/++L+tqkv++rwnPdfPobHlJKFf19VerWdbms4F52RnQP+bz91M3+/+fov0mdWPJlzbzal3O0mV1lU7ydC3UHP+sKIj7PwcKwvytLuf/A0lBkpmBCgAA','1','a67a51c4-c8a6-11e5-a5f1-00e04c78468e','0','','Admin@LabTech',NOW());
INSERT INTO `lt_scripts` (`FolderId`, `ScriptName`, `ScriptNotes`, `Permission`, `EditPermission`, `ComputerScript`, `LocationScript`, `MaintenanceScript`, `FunctionScript`, `LicenseData`, `ScriptData`, `ScriptVersion`, `ScriptGuid`, `ScriptFlags`, `Parameters`, `Last_User`, `Last_Date`) VALUES(@lunfolderid,'Update Device Status','The purpose of this script is to update the status of network devices.','0,','0,','1','1','0','0','H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ih4/L6b5ssmfZm129PjN9So/2n18l38+frVenlTrZZvXRzuP73p/PT59typqvJMffVEtZ9n1KH2WT+p1Vl+nO7ujdG9n99P0/qP9e492DtLjLx7f9V54/HpaF6v2J/O6KaolIIcf6Pefr4vZ0fmnO+fZp59m29OD7NPt3d38/nZ2/3x3e2cn39mfPjjY//QgN+/zC4/v+uP5jZP/B1tAYW3fAAAA','H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ih6/ntbFqn2atdnRb5ykqf7d8B/05+m7ts7w7bMiL2dNetd88TKrs0Xe5rX32edlNcnK5miWXxbTvFisqrr9/Vd1dUFNf/9V1s4/O/nd7x3/7vdPnr95Pc/qHL+tl1n9pM7zH+AveUVeb8b5u/zxXQNTuxD0fpK6Larl0e7ju+EHQavP18Xs6PzTnfPs00+z7elB9un27m5+fzu7f767vbOT7+xPHxzsf3qQGyj8AlNBP2h8mrxu85XF43jaKgL6m37+bL3kv89m+M77yyfbboeMe52/73X+3u/8fd/9/ZrodbRD+OKnfnZSLdtiuc7xuf1dv/uyeV4sCn7F/KrfnC1n+bLNeDD0rf+nTxJHhQ1k2dtEloNhuhz97mXbXE5nRf27/77KBYTCuhn/dFMtH9/VRj8M0u3+v5F0ew83kO7VerkslhdpO8/T86osqyv8VS35g+fZ5E0+nadNXl/m9aP09zQi2hPR3zP96PfEzzfVV6uyymb57FlR5r/nR+le+ntOq8VqTSJfzH7Pn5XJ2P3/Eh8/uLdhMjbQN065o999reQ+J3L/7nFq730Qdff+P8XqDzZQ99u/1+nv8/s///Lk+Pnv/8XxybfPXpz+vq+/fPbmu8evTn/f71ZXn+7f23tRzfLfV7n+931ZV5P8933NquSR/DiZZ8uLfDYwGTtxgtvP770X4e/9v5jwfcJv0jFCu7xJm3m1LmfpsrpKJ3m6Xs2yNp+Nf1aUwv7PgVIwf6tb9P8AGybaCiUJAAA=','1','f60fa66a-c8a6-11e5-a5f1-00e04c78468e','0','','Admin@LabTech',NOW());

SET @DeviceUpdateStatusScriptID = (SELECT `ScriptID` FROM `lt_scripts` WHERE `ScriptName`='Update Device Status');
SET @DeviceInventoryScriptID = (SELECT `ScriptID` FROM `lt_scripts` WHERE `ScriptName`='Update Network Inventory');

/* Add EDFs for configuration through LabTech*/

INSERT INTO `extrafield` (`Form`, `Name`, `Sort`, `NoBreak`, `FType`, `Section`, `UnEditable`, `Collapsed`, `Fill`, `LtGuid`, `IsPassword`, `IsEncrypted`, `IsHidden`, `IsRestricted`, `ViewPermissions`, `EditPermissions`) VALUES('1','Scan Ranges','1','0','0','Lunar Breeze Configuration','0','0','This field should contain semicolon deliminited scan ranges like \'192.168.1.1,253\'.','f9f6b33b-d5b5-44e7-b860-4d835091902d','0','0','0','0','','');
INSERT INTO `extrafield` (`Form`, `Name`, `Sort`, `NoBreak`, `FType`, `Section`, `UnEditable`, `Collapsed`, `Fill`, `LtGuid`, `IsPassword`, `IsEncrypted`, `IsHidden`, `IsRestricted`, `ViewPermissions`, `EditPermissions`) VALUES('1','Operations Log Level','2','0','2','Lunar Breeze Configuration','0','0','None~Errors~Errors + Informational Messages','62a1b8cf-4653-4f85-89d6-f83d41a907c2','0','0','0','0','','');
INSERT INTO `extrafield` (`Form`, `Name`, `Sort`, `NoBreak`, `FType`, `Section`, `UnEditable`, `Collapsed`, `Fill`, `LtGuid`, `IsPassword`, `IsEncrypted`, `IsHidden`, `IsRestricted`, `ViewPermissions`, `EditPermissions`) VALUES('1','Discovery Log Level','3','0','2','Lunar Breeze Configuration','0','0','None~Errors~Errors + Informational Messages','5d76ba4b-e8f7-484a-8b1d-1fa659d918f3','0','0','0','0','','');
INSERT INTO `extrafield` (`Form`, `Name`, `Sort`, `NoBreak`, `FType`, `Section`, `UnEditable`, `Collapsed`, `Fill`, `LtGuid`, `IsPassword`, `IsEncrypted`, `IsHidden`, `IsRestricted`, `ViewPermissions`, `EditPermissions`) VALUES('1','Enable Monitoring','0','0','1','Lunar Breeze Configuration','0','0','Check this box to mark this computer as an enabled monitoring computer.','197c2785-a2f5-4a65-86ba-53a5b87a35a0','0','0','0','0','','');

SET @oplogEDFID = (SELECT `ID` FROM `extrafield` WHERE `Form`=1 AND `Section`='Lunar Breeze Configuration' AND `Name` = 'Operations Log Level');
SET @disclogEDFID = (SELECT `ID` FROM `extrafield` WHERE `Form`=1 AND `Section`='Lunar Breeze Configuration' AND `Name` = 'Discovery Log Level');

INSERT INTO `extrafielddata` (`ID`, `ExtraFieldID`, `Value`) VALUES ('0', @oplogEDFID, 'Errors');
INSERT INTO `extrafielddata` (`ID`, `ExtraFieldID`, `Value`) VALUES ('0', @disclogEDFID, 'Errors');

/* Create table for storage of found devices */

CREATE TABLE IF NOT EXISTS `plugin_lunarbreeze_devices` (
  `deviceID` INT(11) NOT NULL AUTO_INCREMENT,
  `deviceComputerID` INT(11) DEFAULT NULL,
  `deviceHostname` VARCHAR(255) DEFAULT NULL,
  `deviceMACAddress` VARCHAR(17) NOT NULL,
  `deviceIPAddress` VARCHAR(45) DEFAULT NULL,
  `deviceOpenPorts` TEXT,
  `deviceSNMPEnabled` SMALLINT(6) DEFAULT NULL,
  `deviceSNMPCommStrings` TEXT,
  `deviceOnline` SMALLINT(6) DEFAULT NULL,
  `deviceLastUpdate` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`deviceMACAddress`),
  KEY `deviceID` (`deviceID`),
  KEY `computerid` (`deviceComputerID`)
);


/* Create view for accessing `plugin_lunarbreeze_devices` content */

CREATE VIEW `labtech`.`v_lunarbreeze_devices` AS
(
SELECT `plb`.`DeviceID`, `plb`.`deviceComputerID` AS `ComputerID`, `plb`.`deviceHostname` AS `Hostname`, `plb`.`deviceIPAddress` AS `IP`,
`plb`.`deviceOpenPorts` AS `Ports`, `plb`.`deviceSNMPEnabled` AS `SNMPEnabled`, `plb`.`deviceSNMPCommStrings` AS `CommunityStrings`,
`plb`.`deviceOnline` AS `Online`, `plb`.`deviceLastUpdate` AS `LastUpdate`, `c`.`name` AS `AgentName`, `cl`.`Name` AS `ClientName`, 
`l`.`Name` AS `LocationName`
FROM `plugin_lunarbreeze_devices` plb
LEFT JOIN `computers` c ON c.computerid = plb.devicecomputerid
LEFT JOIN `clients` cl ON c.clientid=cl.clientid
LEFT JOIN `locations` l ON c.locationid=l.locationid
);

/* Add Dataview for viewing content in LabTech */

INSERT INTO `dataviewfolders` (`Name`) VALUES ('Lunar Breeze');
SET @InventoryFolderID = (SELECT IFNULL((SELECT `FolderID` FROM `dataviewfolders` WHERE `Name`='Lunar Breeze'),2));
INSERT INTO `dataviews` (`Name`, `FieldList`, `ColumnList`, `HiddenList`, `SQLBody`, `IDColumn`, `SQLWhere`, `FolderID`, `ClientLink`, `ComputerLink`, `SortField`, `GroupField`, `SortOrder`, `FilterControl`, `FormatControl`, `LocationLink`, `IconControl`, `SystemPermission`, `UserClassName`, `GUID`) VALUES('LB Device Inventory','v_lunarbreeze_devices.`deviceid` as `Device ID`, v_lunarbreeze_devices.`hostname` as `Hostname`, v_lunarbreeze_devices.`ip` as `IP Address`, v_lunarbreeze_devices.`ports` as `Ports`, IF(v_lunarbreeze_devices.`snmpenabled`>0;;\'Enabled\';;\'Disabled\') as `SNMP Status`, v_lunarbreeze_devices.`communitystrings` as `SNMP Community Strings`, IF(v_lunarbreeze_devices.`online`>0;; \'Online\';; \'Offline\') as `Status`, v_lunarbreeze_devices.`lastupdate` as `Last Update`, v_lunarbreeze_devices.`agentname` as `Computer Name`, v_lunarbreeze_devices.`clientname` as `Client Name`, v_lunarbreeze_devices.`locationname` as `Client Location`','Computer Name,Client Name,Client Location,Hostname,IP Address,Ports,SNMP Status,SNMP Community Strings,Status,Last Update','','FROM v_lunarbreeze_devices','v_lunarbreeze_devices.`deviceid`','',@InventoryFolderID,'','v_lunarbreeze_devices.computerid','','','0','','','','5|','-1','','11b122f5-5cc1-4594-85ab-df5e99364132');

/* Create a search to find agents with monitoring enabled */

INSERT INTO `searchfolders` (`Name`, `GUID`) VALUES ('Lunar Breeze', UUID());
SET @LBSearchFolderID = (SELECT `FolderID` FROM `searchfolders` WHERE `Name`='Lunar Breeze');
INSERT INTO `sensorchecks` (`Name`, `SQL`, `QueryType`, `ListDATA`, `FolderID`, `GUID`, `SearchXML`) VALUES('Lunar Breeze Monitoring Enabled','Select DISTINCT Computers.ComputerID, Clients.Name as `Client Name`, Computers.Name as ComputerName, Computers.Domain, Computers.UserName, v_extradatacomputers.`Enable Monitoring` as `v_extradatacomputers_Enable Monitoring` from Computers, Clients, v_extradatacomputers Where Computers.ClientID = Clients.ClientID and v_extradatacomputers.ComputerID = Computers.ComputerID and ((v_extradatacomputers.`Enable Monitoring` = 1))','4','Related - Additional Fields|Enable Monitoring (v_extradatacomputers)|=|1|=||=|^Select||=||=||=|^Select|||||||^',@LBSearchFolderID,NULL,'');
SET @LBMonitoringSearchID = (SELECT `SensID` FROM `sensorchecks` WHERE `Name`='Lunar Breeze Monitoring Enabled');

/* Create a group for device monitoring agents */

SET @SystemAutomationGroupID = (SELECT `groupid` FROM `mastergroups` WHERE `FullName`='_System Automation');
INSERT INTO `mastergroups` (`ParentID`, `Parents`, `Children`, `depth`, `Name`, `FullName`, `Permissions`, `Template`, `AutoJoinScript`, `Master`, `LimitToParent`, `Control`, `ControlID`, `Notes`, `MaintenanceID`, `MaintWindowApplied`, `GroupType`, `Priority`, `GUID`, `assetID`, `NetworkPermissions`, `NetworkJoin`, `NetworkJoinOptions`, `ContactPermissions`, `ContactJoin`, `ContactJoinOptions`) VALUES(@SystemAutomationGroupID,CONCAT(',',@SystemAutomationGroupID,','),',','1','Lunar Breeze','_System Automation.Lunar Breeze','0','0','0','2','0','0','0','This group is a top level group for the Lunar Breeze solution. It should not have direct members.','0','2016-02-01 00:56:37','4','5','595276fa-c8a8-11e5-a5f1-00e04c78468e',NULL,NULL,'0','0',NULL,'0','0');
SET @LunarBreezeParentGroupID = (SELECT `groupid` FROM `mastergroups` WHERE `FullName`='_System Automation.Lunar Breeze');
INSERT INTO `mastergroups` (`ParentID`, `Parents`, `Children`, `depth`, `Name`, `FullName`, `Permissions`, `Template`, `AutoJoinScript`, `Master`, `LimitToParent`, `Control`, `ControlID`, `Notes`, `MaintenanceID`, `MaintWindowApplied`, `GroupType`, `Priority`, `GUID`, `assetID`, `NetworkPermissions`, `NetworkJoin`, `NetworkJoinOptions`, `ContactPermissions`, `ContactJoin`, `ContactJoinOptions`) VALUES(@LunarBreezeParentGroupID,CONCAT(',',@SystemAutomationGroupID,',',@LunarBreezeParentGroupID,','),',','2','Monitoring Agents','_System Automation.Lunar Breeze.Monitoring Agents','0','0',@LBMonitoringSearchID,'2','1','0','0','This group contains agents that have monitoring enabled. This adds monitors for registry keys that will in turn launch update scripts.','0','2016-02-01 01:18:33','4','5','4016bed8-c8a9-11e5-a5f1-00e04c78468e',NULL,NULL,'0','0',NULL,'0','0');
SET @LunarBreezeMonitoringGroupID = (SELECT `GroupID` FROM `mastergroups` WHERE `FullName`='_System Automation.Lunar Breeze.Monitoring Agents');
UPDATE `mastergroups` SET `Children`= CONCAT(',',@LunarBreezeMonitoringGroupID,',') WHERE `GroupID`=@LunarBreezeParentGroupID;

/* Create Alert Templates for Updating Device Status and Inventories */

INSERT INTO `alerttemplate` (`Name`, `Comment`, `Last_User`, `Last_Date`, `Permission`, `EditPermission`, `GUID`) VALUES('Lunar Breeze - Update Device Status','This alert template will run a script to update devices statuses.','Admin',NOW(),'','','9b5aca8c-14be-4f40-a80b-a9905ae251ec');
INSERT INTO `alerttemplate` (`Name`, `Comment`, `Last_User`, `Last_Date`, `Permission`, `EditPermission`, `GUID`) VALUES('Lunar Breeze - Update Devices','This alert template will call a script to update the network device inventory.','Admin',NOW(),'','','22a39168-bc21-489c-bf3c-1769a3bb33d0');
SET @UpdateStatusAlertTemplate = (SELECT `AlertActionID` FROM `alerttemplate` WHERE `Name`='Lunar Breeze - Update Device Status');
SET @UpdateInventoryAlertTemplate = (SELECT `AlertActionID` FROM `alerttemplate` WHERE `Name`='Lunar Breeze - Update Devices');
INSERT INTO `alerttemplates` (`AlertActionID`, `DayOfWeek`, `TimeStart`, `TimeEnd`, `AlertAction`, `ContactID`, `UserID`, `ScriptID`, `Message`, `Trump`, `GUID`, `WarningAction`) VALUES(@UpdateStatusAlertTemplate,'127','00:00:00','23:59:00','512','0','1',@DeviceUpdateStatusScriptID,'','0','be1677d5-3aa6-49b9-833f-89b7d62724ae','0');
INSERT INTO `alerttemplates` (`AlertActionID`, `DayOfWeek`, `TimeStart`, `TimeEnd`, `AlertAction`, `ContactID`, `UserID`, `ScriptID`, `Message`, `Trump`, `GUID`, `WarningAction`) VALUES(@UpdateInventoryAlertTemplate,'127','00:00:00','23:59:00','512','0','1',@DeviceInventoryScriptID,'','0','8273e511-153f-427b-9969-592e9a4265f6','0');

/* Create Monitors for Updated Status and Inventory */

INSERT INTO `groupagents` (`GroupID`, `SearchID`, `Name`, `CheckAction`, `AlertAction`, `AlertMessage`, `ContactID`, `interval`, `Where`, `What`, `DataOut`, `Comparor`, `DataIn`, `IDField`, `AlertStyle`, `ScriptID`, `DataCollector`, `Category`, `TicketCategory`, `ScriptTarget`, `GUID`) VALUES(@LunarBreezeMonitoringGroupID,@LBMonitoringSearchID,'Device Status Current','6',@UpdateStatusAlertTemplate,'%NAME% %STATUS% on %CLIENTNAME%\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.!!!%NAME% %STATUS% on %CLIENTNAME%\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.','0','30','127.0.0.1','4','HKLM%5cSOFTWARE%5cWow6432Node%5cLabTech%5cProbe%5cStatus:StatusChanged','7','Value Not Found,0','','1','0','','8','108','1',NULL);
INSERT INTO `groupagents` (`GroupID`, `SearchID`, `Name`, `CheckAction`, `AlertAction`, `AlertMessage`, `ContactID`, `interval`, `Where`, `What`, `DataOut`, `Comparor`, `DataIn`, `IDField`, `AlertStyle`, `ScriptID`, `DataCollector`, `Category`, `TicketCategory`, `ScriptTarget`, `GUID`) VALUES(@LunarBreezeMonitoringGroupID,@LBMonitoringSearchID,'Device Inventory Current','6',@UpdateInventoryAlertTemplate,'%NAME% %STATUS% on %CLIENTNAME%\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.!!!%NAME% %STATUS% on %CLIENTNAME%\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.','0','30','127.0.0.1','4','HKLM%5cSOFTWARE%5cWow6432Node%5cLabTech%5cProbe%5cStatus:InventoryUpdated','7','Value Not Found,0','','1','0','','8','108','1',NULL);
